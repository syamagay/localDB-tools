{% extends "layout.html" %}    <!-- これで元になるHTML(laytout.html)を指定 -->
{% block body %}    <!-- layout.htmlのbodyというブロックを以下で置き換える -->

  <div class="container">
    <div class="row align-items-center justify-content-center">
      <div class="col">

        <h1>Chip Summary : {{ chip['serialNumber'] }}</h1>

        <table class="table table-sm table-hover table-striped" style="font-size: 10pt;">
          <h4 style="font-size: 12pt;">Index</h4>
          <thead>
            <tr>
              <th scope="col" width="150">Item</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                FE type
              </td>
              <td>
                {{ chip['componentType'] }}
              </td>
            </tr>
            <tr>
              <td>
                Serial Number 
              </td>
              <td>
                {{ chip['serialNumber'] }} 
              </td>
            </tr>
          </tbody>
        </table>

        {% if chip['dataIndex'][0] == _brank %}
        {% else %}
        <table class="table table-sm table-hover table-striped" style="font-size: 10pt;">
          <h4 style="font-size: 12pt;">Result</h4>
          <thead>
            <tr>
              <th scope="col" colspan="4">Run Number : {{chip['dataIndex'][0]['runNumber']}}&ensp;&ensp;Test Type : {{chip['dataIndex'][0]['testType']}}</th>
  	        </tr>
          </thead>
          <tbody>
            {% for data in chip['dataIndex'] %}
              {% if loop.index == 1 %}
                <tr>
              {% elif loop.index %4 == 1 %}
                </tr>
                <tr>
              {% else %}
              {% endif %}
              <td>
                <center>
                <a href={{ data['url'] }} target="_brank">
                  <img src={{ data['url'] }} title={{ data['filename'] }} width="150" height="150">
                  </img>
                </a>
                <p>
                  {{ data['filename'] }}
                </p>
                </center>
              </td>
            {% endfor %}
            </tr>
          </tbody>
        </table>
        {% endif %}

        <table class="table table-sm table-hover table-striped" style="font-size: 10pt;">
          <h4 style="font-size: 12pt;">Test index</h4>
          <thead>
            <tr>
              <th scope="col" rowspan="2" width="100">Run number</th>
              <th scope="col" colspan="3" width="30">Environment</th>
              <th scope="col" rowspan="2" width="250">Date</th>
            </tr>
            <tr>
              <th scope="col">HV[V]</th>
              <th scope="col">temp[℃]</th>
              <th scope="col">stage</th>
            </tr>
          </thead>
          <tbody>
          {% for scan in chip['scanIndex'] %}
            <tr>
              <td colspan="5" style="font-size: 10pt; background: #CC99CC;">{{ scan['testType'] }}</td>
            </tr>
              {% for run in scan['run'] %}
                <tr>
                  <td>
                    <a href="{{ url_for('show_chip', id=chip['_id'], runId=run['_id']) }}">{{ run['runNumber'] }}</a>
                  </td>
                  <td>{{ run['environment.hv'] }}</td>
                  <td>{{ run['environment.cool'] }}</td>
                  <td>{{ run['environment.stage'] }}</td>
                  <td>{{ run['datetime'] }}</td>
                </tr>
              {% endfor %}
          {% endfor %}
          </tbody>
        </table>
     </div>
    </div>
  </div>
{% endblock %}
