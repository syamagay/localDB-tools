-- User guide --

< Setting >
1, requirements
- mongodb 
- python 2.X or 3.X ( which can use PyROOT )
  * pip install pillow
  * pip install pymongo
  * pip install pdf2image
  * pip install Flask-PyMongo
  * pip install python-dateutil 
  * pip install flask-httpauth

2, preparetion
 > 1, git clone this source
      git clone https://gitlab.cern.ch/akubota/web-app-db-yarr.git
 > 2, modify some points
      in app.py
        l32. app.config["MONGO_URI"] = "mongodb://<IP address>:<port>/<dbName>" 
        l36. client = MongoClient(host=<IP address>, port=<port>)
        l37. userdb = client[<User dbName>]
        * IP address : "localhost" or IP address of server with mongodb
        * port : TCP port used by mongodb (default:27017)
        * dbName : select database to show (default:yarrdb)
       
        last. app.run(host='<IP address>')
        * IP address : "127.0.0.1" or IP address of the machine that flask app is running
 > 3, run 
      <in running mongodb>
      python app.py
      type "<IP address>:5000" in browser

< Setup pyenv >

1, yum install some packages
 $ sudo yum install gcc zlib-devel bzip2 bzip2-devel readline readline-devel sqlite sqlite-devel openssl openssl-devel git
2, install pyenv
 i, clone pyenv repository
   $ git clone https://github.com/pyenv/pyenv.git ~/.pyenv
 ii, add path to pyenv in bash_profile
   $ echo 'export PATH="$HOME/.pyenv/bin:$PATH"' >> ~/.bash_profile
   $ echo 'eval "$(pyenv init -)"' >> ~/.bash_profile
   $ source ~/.bash_profile
  iii, check version of pyenv
   $ pyenv --version
   pyenv 1.2.2.6-g694b551
3, install python X.X.X using pyenv
  i, install
   $ pyenv install X.X.X
  ii, change version of python
   $ pyenv global X.X.X
   $ pyenv local X.X.X (only current directory)

< pip install >
1, ./make_install.sh
2, python install.py

< Setting script >
1, Change some materials in setting.sh and execute it
  - APACHE : true : run by apache
  - IPADDRESS : where you run this web app
  - PORT : port of mongoDB
  - ADMIN & PASS : user name and password for admin page 
2, ./setting.sh

< web-app-db-yarr >
| 
|- app.py 
|     : main program     
|- PlotTools/, root.py, parameter_default.json
|     : for making histogram using PyROOT
|- func.py
|     : detailed function program
|- img.py 
|     : convert to dataURI from binary data of png/jpeg image
|
|- static/
|    |- assets 
|    |    : for bootstrap 
|    |- upload 
|    |    : directory ro save images for displaying summary page temporarily
|
|- templates/
     |- toppage.html
     |    : top page page (html)
     |- module.html
     |    : module page (html)
     |- chip.html
     |    : chip page (html)
     |- display_index.html
     |    : part of displaying result in summary (html)
     |- test_index.html
     |    : part of displaying test run list (html)
     |- result_XXX.html
     |    : part of displaying test result for each component (html)
     |- admin_XXX.html
     |    : admin page (html)
     |- parts
          : header, loader, navigate bar, footer
